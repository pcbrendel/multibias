<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multibias example: Evans • multibias</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multibias example: Evans">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multibias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/multibias.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/evans_example.html">Multibias example: Evans</a></li>
    <li><a class="dropdown-item" href="../articles/multibias_validation.html">Multibias Validation</a></li>
    <li><a class="dropdown-item" href="../articles/nhanes_example.html">Multibias example: NHANES</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pcbrendel/multibias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multibias example: Evans</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pcbrendel/multibias/blob/master/vignettes/evans_example.Rmd" class="external-link"><code>vignettes/evans_example.Rmd</code></a></small>
      <div class="d-none name"><code>evans_example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pcbrendel/multibias" class="external-link">multibias</a></span><span class="op">)</span></span></code></pre></div>
<p>We are interested in quantifying the effect of smoking (SMK) on
coronary heart disease (CHD) using data from the <a href="https://en.wikipedia.org/wiki/Evans_County_Heart_Study" class="external-link">Evans
County Heart Study</a>. Let’s inspect the dataframe we have for 609
participants aged 40 and older.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">evans</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID CHD AGE CHL SMK ECG DBP SBP HPT</span></span>
<span><span class="co">#&gt; 1 21   0  56 270   0   0  80 138   0</span></span>
<span><span class="co">#&gt; 2 31   0  43 159   1   0  74 128   0</span></span>
<span><span class="co">#&gt; 3 51   1  56 201   1   1 112 164   1</span></span>
<span><span class="co">#&gt; 4 71   0  64 179   1   0 100 200   1</span></span>
<span><span class="co">#&gt; 5 74   0  49 243   1   0  82 145   0</span></span>
<span><span class="co">#&gt; 6 91   0  46 252   1   0  88 142   0</span></span></code></pre></div>
<p>This is clearly not the most robust data, but, for purposes of
demonstrating <code>multibias</code>, let’s proceed by pretending that
our data was missing information on AGE. Let’s inspect the resulting
effect estimate, adjusted for hypertension (HPT).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biased_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">CHD</span> <span class="op">~</span> <span class="va">SMK</span> <span class="op">+</span> <span class="va">HPT</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">evans</span></span>
<span><span class="op">)</span></span>
<span><span class="va">or</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">or_ci_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">or_ci_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Biased Odds Ratio: "</span>, <span class="va">or</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Biased Odds Ratio: 1.99"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI: ("</span>, <span class="va">or_ci_low</span>, <span class="st">", "</span>, <span class="va">or_ci_high</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "95% CI: (1.12, 3.55)"</span></span></code></pre></div>
<p>This estimate is around what we’d expect. In the IJE article <a href="https://doi.org/10.1093/ije/dyv124" class="external-link">The association between
tobacco smoking and coronary heart disease</a> the author notes:
“Cigarette smokers have about twice as much coronary heart disease as
non-smokers, whether measured by deaths, prevalence, or the incidence of
new events.” However, we also know from studies like <a href="https://doi.org/10.1136/bmj.j5855" class="external-link">this BMJ meta-analysis</a> that
the effect estimate can vary greatly depending on the degree of
cigarette consumption.</p>
<p>Can we anticipate whether this odds ratio without age-adjustment is
biased towards or away from the null? Let’s consider the association of
the uncontrolled confounder with the exposure and outcome.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">evans</span><span class="op">$</span><span class="va">SMK</span>, <span class="va">evans</span><span class="op">$</span><span class="va">AGE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.1391298</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">evans</span><span class="op">$</span><span class="va">CHD</span>, <span class="va">evans</span><span class="op">$</span><span class="va">AGE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1393077</span></span></code></pre></div>
<p>In our data, AGE has a negative association with SMK (older people
are <strong>less</strong> likely to be smokers) and a positive
association with CHD (older people are <strong>more</strong> likely to
have CHD). These opposite associations must be biasing the odds ratio
towards the null, creating a distortion where those who are less likely
to smoke are more likely to experience the outcome.</p>
<p>We’ll treat AGE as a binary indicator of over (1) or under (0) age
60. To adjust for the uncontrolled confounding from AGE, let’s refer to
the appropriate bias model for a binary uncontrolled confounder:
logit(P(U=1)) = α<sub>0</sub> + α<sub>1</sub>X + α<sub>2</sub>Y +
α<sub>2+j</sub>C<sub>j</sub>.</p>
<p>To derive the necessary bias parameters, let’s make the following
assumption: * the odds of an age&gt;60 is half as likely in smokers than
non-smokers * the odds of an age&gt;60 is 2.5x in those with CHD than
those without CHD * the odds of an age&gt;60 is 2x in those with HPT
than those without HPT</p>
<p>To convert these relationships as parameters in the model, we’ll
log-transform them from odds ratios. For the model intercept, we can use
the following reasoning: what is the probability that a non-smoker (X=0)
without CHD (Y=0) and HPT (C=0) is over age 60 in this population? We’ll
assume this is a 25% probability. We’ll use the inverse logit function
<code><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis()</a></code> from the <code>stats</code> package to convert
this from a probability to the intercept coefficient of the logistic
regression model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">u_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">u_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="va">u_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s plug these bias parameters into <code><a href="../reference/adjust_uc.html">adjust_uc()</a></code>
along with our <code>data_observed</code> object to obtain our
bias-adjusted odds ratio.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_observed.html">data_observed</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">evans</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"SMK"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"CHD"</span>,</span>
<span>  confounders <span class="op">=</span> <span class="st">"HPT"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/adjust_uc.html">adjust_uc</a></span><span class="op">(</span></span>
<span>  <span class="va">df_obs</span>,</span>
<span>  u_model_coefs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">u_0</span>, <span class="va">u_x</span>, <span class="va">u_y</span>, <span class="va">u_c</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimate</span></span>
<span><span class="co">#&gt; [1] 2.279489</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt; [1] 1.261951 4.117491</span></span></code></pre></div>
<p>We get an odds ratio of 2.3 (95% CI: 1.3, 4.1). This matches our
expectation that the bias adjustment would pull the odds ratio away from
the null. How does this result compare to the result we would get if age
<strong>wasn’t</strong> missing in the data and was incorporated in the
outcome regression?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">CHD</span> <span class="op">~</span> <span class="va">SMK</span> <span class="op">+</span> <span class="va">HPT</span> <span class="op">+</span> <span class="va">AGE</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">evans</span></span>
<span><span class="op">)</span></span>
<span><span class="va">or</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">or_ci_low</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">or_ci_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">biased_model</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">full_model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Odds Ratio: "</span>, <span class="va">or</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Odds Ratio: 2.31"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"95% CI: ("</span>, <span class="va">or_ci_low</span>, <span class="st">", "</span>, <span class="va">or_ci_high</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "95% CI: (1.1, 3.6)"</span></span></code></pre></div>
<p>It turns out that our bias-adjusted odds ratio using
<code>multibias</code> is close to this complete-data odds ratio of
2.3.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Brendel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
