<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to multibias • multibias</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to multibias">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">multibias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/multibias.html">Get Started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/nhanes_example.html">NHANES Example</a></li>
    <li><a class="dropdown-item" href="../articles/evans_example.html">Evans Example</a></li>
    <li><a class="dropdown-item" href="../articles/multibias_validation.html">Multibias Validation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pcbrendel/multibias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to multibias</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pcbrendel/multibias/blob/master/vignettes/multibias.Rmd" class="external-link"><code>vignettes/multibias.Rmd</code></a></small>
      <div class="d-none name"><code>multibias.Rmd</code></div>
    </div>

    
    
<p>Multibias makes it easy to simultaneously adjust for multiple biases
in causal inference research. This document walks you through the key
steps to performing the analysis.</p>
<div class="section level2">
<h2 id="create-data_observed">1. Create data_observed<a class="anchor" aria-label="anchor" href="#create-data_observed"></a>
</h2>
<p>Represent your observed data as a <code>data_observed</code> object.
Here you include the dataframe, specify the key variables in the data,
and identify the bias impacting the data. All epidemiological biases can
be generalized into four main groups:</p>
<ul>
<li>Uncontrolled confounding (<strong>uc</strong>)</li>
<li>Exposure misclassificaiton (<strong>em</strong>)</li>
<li>Outcome misclassificaiton (<strong>om</strong>)</li>
<li>Selection bias (<strong>sel</strong>)</li>
</ul>
<p>Multibias is capable of handling bias adjustment for most of the
combinations of the above four biases.</p>
<p>For purposes of demonstration, multibias includes datasets with
different bias combinations. For a given bias or biases, it includes the
biased data (e.g., <code>df_uc_sel</code>: missing a confounder and not
including the un-selected subjects) and the source used to derive the
biased data (e.g., <code>df_uc_sel_source</code>: including data on the
missing confounder and subjects who were not selected).</p>
<p>Each dataset has variables defined similarly:</p>
<ul>
<li>
<code>X</code> = binary exposure</li>
<li>
<code>Y</code> = binary outcome</li>
<li>
<code>C1-C3</code> = binary confounders</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_observed.html">data_observed</a></span><span class="op">(</span></span>
<span>  <span class="va">df_uc_sel</span>,</span>
<span>  bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uc"</span>, <span class="st">"sel"</span><span class="op">)</span>,</span>
<span>  exposure <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-source-for-bias-adjustment">2. Create source for bias adjustment<a class="anchor" aria-label="anchor" href="#create-source-for-bias-adjustment"></a>
</h2>
<p>Next, you need to have some information that can be used to quantify
the assumed bias or biases. There are two options here.</p>
<div class="section level3">
<h3 id="option-1-bias-parameters">Option 1: Bias parameters<a class="anchor" aria-label="anchor" href="#option-1-bias-parameters"></a>
</h3>
<p>One option is to list the assumed parameters for the corresponding
bias equations. The necessary bias equations are provided in the
documentation of each <code>adjust()</code> function. These equations
can be derived using the methods outlined in the article <a href="https://doi.org/10.1093/ije/dyad001" class="external-link">here</a>. In our example, we
have bias parameters to predict the missing binary confounder
<code>U</code> (as the vector <code>u_coefs</code>) and study selection
indicator <code>S</code> (as the vector <code>s_coefs</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bias_params.html">bias_params</a></span><span class="op">(</span></span>
<span>  coef_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    u <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.19</span>, <span class="fl">0.61</span>, <span class="fl">0.72</span>, <span class="op">-</span><span class="fl">0.09</span>, <span class="fl">0.10</span>, <span class="op">-</span><span class="fl">0.15</span><span class="op">)</span>,</span>
<span>    s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.01</span>, <span class="fl">0.92</span>, <span class="fl">0.94</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="option-2-validation-data">Option 2: Validation data<a class="anchor" aria-label="anchor" href="#option-2-validation-data"></a>
</h3>
<p>A second option is to specify a validation data source as a
<code>data_validation</code> object. In order to adjust for a given
bias, the validation data must have the corresonding missing data. In
the example here, the validation data has additional columns for the
missing binary confounder <code>U</code> and indicator <code>S</code>
for whether a given individual was selected into the study.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_validation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_validation.html">data_validation</a></span><span class="op">(</span></span>
<span>  <span class="va">df_uc_sel_source</span>,</span>
<span>  true_exposure <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>  true_outcome <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>, <span class="st">"U"</span><span class="op">)</span>,</span>
<span>  selection <span class="op">=</span> <span class="st">"S"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="run-the-bias-adjustment">3. Run the bias adjustment<a class="anchor" aria-label="anchor" href="#run-the-bias-adjustment"></a>
</h2>
<p>Finally, we can run the multi-bias adjustment!</p>
<div class="section level3">
<h3 id="single-run">Single run<a class="anchor" aria-label="anchor" href="#single-run"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/multibias_adjust.html">multibias_adjust</a></span><span class="op">(</span></span>
<span>  data_observed <span class="op">=</span> <span class="va">df_observed</span>,</span>
<span>  bias_params <span class="op">=</span> <span class="va">bp</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimate</span></span>
<span><span class="co">#&gt; [1] 2.001141</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt; [1] 1.948436 2.055271</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/multibias_adjust.html">multibias_adjust</a></span><span class="op">(</span></span>
<span>  data_observed <span class="op">=</span> <span class="va">df_observed</span>,</span>
<span>  data_validation <span class="op">=</span> <span class="va">df_validation</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $estimate</span></span>
<span><span class="co">#&gt; [1] 2.001603</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ci</span></span>
<span><span class="co">#&gt; [1] 1.948854 2.055779</span></span></code></pre></div>
<p>We observe that the bias-adjusted odds ratio of the effect of X on Y
is approximately 2. This effect can be compared to the effect observed
in the biased data to understand whether systematic error is bringing
the observed effect closer to the null or further from the null.</p>
</div>
<div class="section level3">
<h3 id="bootstrapping">Bootstrapping<a class="anchor" aria-label="anchor" href="#bootstrapping"></a>
</h3>
<p>Multibias performs bias adjustment via a combination of imputation
and/or regression weighting. When imputation is involved, there will be
some inherent randomness in the sampling. A single run, therefore, will
not produce an exactly consistent result unless a seed is specified.
Bootstrapping is thus recommended to quantify the random error.
Computational performance can be improved via parallelization.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_uc_sel</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nreps</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nreps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_bootstrap</span> <span class="op">&lt;-</span> <span class="va">df_uc_sel</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">df_observed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_observed.html">data_observed</a></span><span class="op">(</span></span>
<span>    <span class="va">df_bootstrap</span>,</span>
<span>    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uc"</span>, <span class="st">"sel"</span><span class="op">)</span>,</span>
<span>    exposure <span class="op">=</span> <span class="st">"X"</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>    confounders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multibias_adjust.html">multibias_adjust</a></span><span class="op">(</span></span>
<span>    <span class="va">df_observed</span>,</span>
<span>    <span class="va">df_validation</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">est</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># odds ratio estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="co"># confidence interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">est</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.975</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  2.5% 97.5% </span></span>
<span><span class="co">#&gt;  1.94  2.06</span></span></code></pre></div>
<p>When adjusting via bias parameters, the user can alternatively
provide each bias parameter value as a probability distribution. The
resulting confidence interval from bootstrapping can then quantify
uncertainty in both the random error and the systematic error. Check out
the vignette article “Multibias Validation” for a demonstration of this
approach.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Brendel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
